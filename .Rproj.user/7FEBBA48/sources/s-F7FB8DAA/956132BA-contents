#' @include reporter.R stack.R
NULL

#' Test reporter: interactive progress bar of errors.
#'
#' This reporter is a reimagining of [SummaryReporter] desgined to make the
#' most information available up front, while taking up less space overall. It
#' is the default reporting reporter used by [test_dir()] and [test_file()].
#'
#' As an additional benefit, this reporter will praise you from time-to-time
#' if all your tests pass.
#'
#' @export
#' @family reporters
test_Doctor <- R6::R6Class("testDoctor",
                                inherit = testthat::Reporter,
                                public = list(

                                  resultsList = list(),
                                  add_result = function(context, test, result) {

                                    if(!missing(context)){
                                      print(paste("context:",context))
                                    }
                                    if(!missing(test)){
                                      print(paste("test:",test))
                                    }
                                    if(!missing(result)){
                                      self$resultsList<-list(self$resultsList,result)
                                      print(paste("result:",result))
                                    }

                                    self$ctxt_n <- self$ctxt_n + 1L

                                    if (testthat:::expectation_broken(result)) {
                                      self$n_fail <- self$n_fail + 1
                                      self$ctxt_n_fail <- self$ctxt_n_fail + 1
                                      self$ctxt_issues$push(result)

                                    } else if (testthat:::expectation_skip(result)) {
                                      self$n_skip <- self$n_skip + 1
                                      self$ctxt_n_skip <- self$ctxt_n_skip + 1
                                      self$ctxt_issues$push(result)

                                    } else if (testthat:::expectation_warning(result)) {
                                      self$n_warn <- self$n_warn + 1
                                      self$ctxt_n_warn <- self$ctxt_n_warn + 1
                                      self$ctxt_issues$push(result)

                                    } else {

                                      self$n_ok <- self$n_ok + 1
                                      self$ctxt_n_ok <- self$ctxt_n_ok + 1
                                    }

                                    self$show_status()
                                  }
                                )
)
